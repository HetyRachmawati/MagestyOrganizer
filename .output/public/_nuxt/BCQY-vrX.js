import{_ as y}from"./-Si7dSij.js";import{_ as k,r as n,u as I,o as d,c,a as e,s as L,v as m,x as p,t as f,y as S,d as g,b as P,w as E,z as N,A as R}from"./BqTsYXpV.js";import{_ as V}from"./cJP_bxJ8.js";const B={class:"min-h-screen flex items-center justify-center bg-purple-50 p-4"},C={class:"relative flex flex-col border border-purple-600 shadow-lg p-6 rounded-lg bg-white w-full max-w-md lg:max-w-lg"},M={class:"w-full"},A={class:"bg-white p-4 rounded-lg shadow-md"},T={key:0,class:"text-red-500 text-center"},Y=["disabled"],$={class:"text-center text-sm mt-4"},D={__name:"LoginForm",setup(v){const l=n(""),a=n(""),s=n(""),r=n(!1),u=I(),x=N(),b=async()=>{if(s.value="",!l.value||!a.value){s.value="Please enter both email and password";return}r.value=!0;try{const o=await $fetch(`${x.public.apiBase}/login`,{method:"POST",body:{email:l.value,password:a.value}});console.log("API Response:",o),o.status==="success"&&o.data.token?(typeof window<"u"&&(localStorage.setItem("token",o.data.token),localStorage.setItem("name",o.data.user.name),localStorage.setItem("role_id",o.data.user.level.id)),o.data.user.level.id===1?await u.push("/admin/dashboard"):(s.value="You do not have access to the admin dashboard",typeof window<"u"&&(localStorage.removeItem("token"),localStorage.removeItem("role_id")))):s.value=o.message||"Invalid login credentials"}catch(o){console.error("Login failed:",o),s.value="Login failed. Please check your credentials or try again later."}finally{r.value=!1}},w=()=>{const o=/^[^\s@]+@[^\s@]+\.[^\s@]+$/;l.value&&!o.test(l.value)?s.value="Please enter a valid email address":s.value=""},_=()=>{u.push("/")};return(o,t)=>{const h=y;return d(),c("div",B,[e("div",C,[e("button",{class:"absolute top-4 right-4 text-purple-500 hover:text-purple-600 focus:outline-none text-2xl font-bold",onClick:_}," Ã— "),t[7]||(t[7]=e("div",{class:"flex flex-col items-center justify-center mb-6"},[e("img",{src:V,alt:"Magesty Organizer Logo",class:"w-24 lg:w-32 mb-4"}),e("h1",{class:"text-purple-500 text-2xl lg:text-3xl font-bold"},"MAGESTY ORGANIZER")],-1)),e("div",M,[e("div",A,[t[6]||(t[6]=e("h2",{class:"text-center text-purple-500 text-2xl font-bold mb-4"},"Login",-1)),e("form",{onSubmit:L(b,["prevent"]),class:"space-y-4"},[e("div",null,[t[2]||(t[2]=e("label",{for:"email",class:"block text-sm font-medium mb-1"},"Email",-1)),m(e("input",{"onUpdate:modelValue":t[0]||(t[0]=i=>l.value=i),type:"email",id:"email",placeholder:"Your Email",required:"",class:"w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-purple-300",onInput:w},null,544),[[p,l.value]])]),e("div",null,[t[3]||(t[3]=e("label",{for:"password",class:"block text-sm font-medium mb-1"},"Password",-1)),m(e("input",{"onUpdate:modelValue":t[1]||(t[1]=i=>a.value=i),type:"password",id:"password",placeholder:"Your Password",required:"",class:"w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-purple-300"},null,512),[[p,a.value]])]),s.value?(d(),c("div",T,f(s.value),1)):S("",!0),e("button",{type:"submit",class:"w-full bg-purple-500 text-white py-2 rounded-md hover:bg-purple-600 transition-colors font-medium",disabled:r.value},f(r.value?"Logging in...":"Login"),9,Y)],32),e("p",$,[t[5]||(t[5]=g(" Don't have an account yet? ")),P(h,{to:"/auth/register",class:"text-purple-500 font-medium hover:underline"},{default:E(()=>t[4]||(t[4]=[g("Register Here")])),_:1})])])])])])}}},O=k(D,[["__scopeId","data-v-afc4e568"]]),F={__name:"login",setup(v){return(l,a)=>(d(),R(O))}};export{F as default};
